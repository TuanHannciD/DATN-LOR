
@{
    ViewData["Title"] = "CheckOut";
    Layout = "~/Views/Shared/_LayoutCheckOut.cshtml";
}
@model List<ChiTietGioHang>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<div class="container">
    <div class="row">
        <div class="col-lg-12">
            <h6>
                <span class="icon_tag_alt"></span> Have a coupon? <a href="#">Click here</a> to enter your code
            </h6>
        </div>
    </div>
    <div class="checkout__form">
        <h4>Thông Tin</h4>
        <form action="@Url.Action("DatHang", "HoaDon")" method="post">
            <div class="row">
                <div class="col-lg-8 col-md-6">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="checkout__input">
                                <p>Họ Tên<span>*</span></p>
                                <input type="text" id="hoten" name="hoten">
                            </div>
                        </div>                        
                    </div>
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="checkout__input">
                                <p>Số điện thoại<span>*</span></p>
                                <input type="text" id="sdt" name="sdt">
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="checkout__input">
                                <p>email<span>*</span></p>
                                <input type="text" id="email" name="email">
                            </div>
                        </div>
                    </div>
                    
                    <div class="checkout__input">
                        <p>Địa chỉ<span>*</span></p>
                        <input type="text" placeholder="" class="checkout__input__add" id="diachi" name="diachi">
                        @* <input type="text" placeholder="Apartment, suite, unite ect (optinal)"> *@
                    </div>                                   
                                               
                    <div class="checkout__input">
                        <p>Ghi chú<span>*</span></p>
                        <input type="text"
                               placeholder="Ghi chú cho đơn hàng" id="ghichu" name="ghichu">
                    </div>
                </div>
                 @* sssss *@
                <div class="col-lg-4 col-md-6">
                    <div class="checkout__order">
                        <h4>Đơn của bạn</h4>
                        <div class="checkout__order__products">Sản phẩm <span>tổng</span></div>
                        <ul>
                             @foreach (var item in Model)
                            {
                                <input type="hidden" name="selectedIds" value="@item.ShoeDetailID">
                                <input type="hidden" name="quantities" value="@item.SoLuong">
                                decimal tong = item.SoLuong * item.ChiTietGiay.Gia;
                                <li>@item.ChiTietGiay.Giay.TenGiay (@item.ChiTietGiay.MauSac.TenMau,@item.ChiTietGiay.KichThuoc.TenKichThuoc) x @item.SoLuong <span>@item.ChiTietGiay.Gia.ToString("N0") VNĐ</span></li>
                            }
                            
                            
                        </ul>
                        
                        @* <div class="checkout__order__subtotal">Subtotal <span>$750.99</span></div> *@
                        <div class="checkout__order__total">tổng <span id="tongtien" name="tongtien">@ViewBag.TongTien.ToString("N0") VNĐ</span></div>

                        <div class="checkout__input__checkbox">
                            <label for="payment">
                                Thanh toán khi nhận
                                <input type="checkbox" name="phuongthuc" id="payment" value="0">
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <div class="checkout__input__checkbox">
                            <label for="paypal">
                                Thanh toán VnPay
                                <input type="checkbox" name="phuongthuc" id="paypal" value="3">
                                <span class="checkmark"></span>
                            </label>
                        </div>
                        <input type="hidden" id="selectedMethod" name="PhuongThuc" />
                        <button type="submit" id="submit-order" class="site-btn">Đặt Hàng</button>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const checkboxes = document.querySelectorAll('input[name="phuongthuc"]');
        const hiddenInput = document.getElementById('selectedMethod');

        checkboxes.forEach(cb => {
            cb.addEventListener('change', function () {
                // Bỏ chọn tất cả
                checkboxes.forEach(c => c.checked = false);
                // Chỉ chọn lại chính nó
                this.checked = true;
                // Gán giá trị vào input hidden
                hiddenInput.value = this.value;
            });
        });

        document.getElementById('submit-order').addEventListener('click', function (e) {
            if (!document.querySelector('input[name="phuongthuc"]:checked')) {
                alert('Vui lòng chọn phương thức thanh toán');
                e.preventDefault(); // Ngăn submit nếu chưa chọn
            }
        });
    });
</script>